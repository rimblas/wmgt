---
# ====== Page: View Results ==================================
id: 60
identification: 
  name: View Results
  alias: VIEW-RESULTS
  title: View Results

appearance: 
  page-mode: Normal
  page-template: Theme Default
  template-options: 
  - '#DEFAULT#'

navigation-menu: 
  override-user-interface-level: true
  list: Tournament Options # 55884590206608414057
  list-position: Top
  list-template: Top Navigation Tabs # 46986647224831702467
  template-options: 
  - '#DEFAULT#'
  - t-NavTabs--inlineLabels-lg
  - t-NavTabs--displayLabels-sm

navigation: 
  cursor-focus: Do not focus cursor
  warn-on-unsaved-changes: false

javascript: 
  file-urls: 
  - //cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js
  function-and-global-variable-declaration: |
    function badgeMenuAction(btn, actionMenu, badge, player) {
     apex.server.process('BADGES'
        , {x01: actionMenu.label.split(' ')[0],
           x02: player,
           x03: badge,
           pageItems: '#P60_TOURNAMENT_SESSION_ID,#P60_BADGE_ID'
          }
        , {
            beforeSend: function(btn) {
              $(btn).parents("tr").find("[headers='BADGES']").append('<span aria-hidden="true" class="fa fa-spinner fa-anim-spin"></span>');
            },
            success: function( pData ) {
                var $cell = $(btn).parents("tr").find("[headers='BADGES']");
                if (pData.status === "ADDED") {
                  $cell.append('<i class="em ' + actionMenu.icon + '" aria-role="presentation" aria-label="' + actionMenu.icon + '"></i>');
                  addBadge($(btn), badge);
                  apex.message.showPageSuccess( badge + " badge added!" );
                  try {
                      $s("P60_BADGE_ID", pData.id);
                  } catch(err) {
                      $s("P60_BADGE_ID","")
                  }
    
                }
                else {
                    $cell.find("i." + actionMenu.icon).remove();
                }            
                $cell.find(".fa-spinner").remove();
            }
        }
     );
    }
    
    function hasBadge(btn$, badge) {
      let badge_json = btn$.data("badges");
      // console.log("hasBadge", badge_json);
      return badge_json.hasOwnProperty(badge);
    }
    
    function addBadge(btn$, badge) {
      let badge_json = btn$.data("badges");
      badge_json[badge] = 'true';
      console.log(badge_json);
      console.log(JSON.stringify(badge_json));
    //  btn$.data("badges", JSON.stringify(badge_json));
      btn$.data("badges", badge_json);
    }
    
    
  execute-when-page-loads: |
    var menu$ = $("<div id='badge_list_menu'></div>");
    $("body").append(menu$);
    menu$.menu({
      iconType: "em",
      items: [
        {
          type: "action",
          label: "Add Diamond",
          icon: "em-large_blue_diamond",
          action: function(menu, btn) {
            // console.log("Adding", button$.data("id"));
            // console.log(this);
            badgeMenuAction(btn, this, 'DIAMOND', btn.dataset.id);
          },
          hide: function () {
              var btn$ = $("button.is-active.js-menuButton");
              return hasBadge(btn$, 'DIAMOND');
          }
        },
        {
          type: "action",
          label: "Add Duck",
          icon: "em-duck",
          action: function(menu, btn) {
            badgeMenuAction(btn, this, 'DUCK', btn.dataset.id);
          }
        },
        {
          type: "action",
          label: "Add Beetle",
          icon: "em-beetle",
          action: function(menu, btn) {
            badgeMenuAction(btn, this, 'BEETLE', btn.dataset.id);
          }
        },
        {
          type: "action",
          label: "Undo",
          icon: "fa fa-undo-arrow",
          action: function(menu, btn) {
            // console.log("Adding", button$.data("id"));
            // console.log(this);
            badgeMenuAction(btn, this, 'DIAMOND', btn.dataset.id);
          },
          hide: function () {
              // var btn$ = $("button.is-active.js-menuButton");
              return true;
              return !!!$v("P60_BADGE_ID");
          }
        },
      ]
    });

css: 
  file-urls: 
  - '#APP_FILES#css/week-lov#MIN#.css'
  - //emoji-css.afeld.me/emoji.css
  inline: |
    @media (max-width: 640px) {
    
        :root {
            --ut-report-cell-padding-y:.2rem;
            --ut-report-cell-padding-x:.4rem;
    
        }
    }
    .hide_nav_next .t-Form-itemText--post {display: none;}
    .hide_nav_pre .t-Form-itemText--pre {display: none;}
    
    #weekResults {
        --ut-report-cell-padding-y: .35rem;
        --ut-report-cell-alt-background-color: #dadada;
    }
    
    @media (max-width: 639px) {
      #POS, td[headers="POS"] {
           --ut-report-cell-padding-x: .4rem;
           --ut-report-header-cell-padding-x: .2rem;
      }
      #COUNTRY_CODE, td[headers="COUNTRY_CODE"] {
           --ut-report-cell-padding-x: .4rem;
           --ut-report-header-cell-padding-x: .1rem;
      }
    }
    
    .w {
        display: inline-block;
        float: right;
    }
    
    .discardY {
        text-decoration: line-through;
        color: #BBB;
    }
    
    .points {
        color: white;
        font-weight: 700;
    }
    .top {
        background-color: hsl(220deg 100% 39%);
    }
    .p10 {
        background-color: hsl(220deg 100% 43%);
    }
    .p9 {
        background-color: hsl(220deg 100% 48%);
    }
    .p8 {
        background-color: hsl(220deg 100% 55%);
    }
    .p7 {
        background-color: hsl(220deg 100% 61%);
    }
    .p6 {
        background-color: hsl(220deg 100% 67%);
    }
    .p5 {
        background-color: hsl(220deg 100% 73%);
    }
    .p4 {
        background-color: hsl(220deg 100% 79%);
    }
    .p3 {
        background-color: hsl(220deg 100% 85%);
    }
    .p2 {
        background-color: hsl(220deg 100% 91%);
        color: #777;
    }
    .p1 {
        background-color: hsl(220deg 100% 97%);
        color: #666;
    }
    
    td[headers="SEASON_TOTAL"] {
        font-weight: bold;
    }
    .&P60_WEEK. {
        background-color: rgb(79, 79, 189);
        color: white;
        font-weight: bold;
    }
    
    .&P60_WEEK..discardY {
        color: #bfbfbf;
        font-weight: normal;
    }
    
    .t-Report--altRowsDefault .t-Report-report tr.mark:nth-child(odd) {
        --ut-report-cell-background-color: #ff0;
        color: #000;
    }
    #raceRegion .t-Report-wrap {float: none;}
    #raceRegion .t-Report-report, 
    #raceRegion .t-Report-wrap {
        min-width: 50%;
    }
    #itemsRegion {
      flex-direction: row;
      display: flex;
      flex-wrap: wrap;
      width: 100%;
      background-color:  var(--ut-region-header-background-color,var(--ut-region-background-color,var(--ut-component-background-color)))
    }
    

security: 
  authentication: Page Is Public

advanced: 
  enable-meta-tags: false

security: 
  deep-linking: Application Default
  page-access-protection: Unrestricted
  form-auto-complete: Off
  browser-cache: Application Default

session-management: 
  rejoin-sessions: Application Default

advanced: 
  enable-duplicate-page-submissions: Yes - Enable page to be re-posted
  reload-on-submit: Only for Success

server-cache: 
  caching: Disabled

help: 
  help-text: |
    The <b>Week Results</b> shows the placement of players and the points they will earn for the week.  
    Click on "About the Points" to understand how points are assigned.<br>
    <br>
    The <b>Season Race</b> shows the placement of players for the duration of the tournament.<br> 
    The crossed out scores on the Season Race are the lowest scored being discarded for a player. Every 3 weeks the lowest
    score is discarded, meaning the best 2 out of 3 scores is used. When you're unable to play that also counts as a low 
    score and will be considered as a discarded score. This way you can miss up to 4 weeks of the 12 week seasion and have
    the same opportunity.

regions: 
- # ====== Region: Season Race (&P60_TOURNAMENT.) ==============
  id: 4008199353738099
  identification: 
    title: Season Race (&P60_TOURNAMENT.)
    type: Classic Report

  source: 
    location: Local Database
    type: SQL Query
    sql-query: |
      with all_weeks as (
        select ts.id tournament_session_id, ts.round_num, ts.week, ts.session_date
         from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
      )
      , all_tournament_players as (
        select distinct p.player_id, w.tournament_session_id, w.round_num, w.week, w.session_date
          from wmg_tournament_players p
             , all_weeks w
         where p.tournament_session_id in (
            select aw.tournament_session_id
             from all_weeks aw
          )
      )
      , sessions_pivot as (
          select player_id
               , max(w1_points)        w1_points
               , max(w1_week)          w1_week
               , max(w1_discarded_points_flag)  w1_discard
               , max(w2_points)        w2_points
               , max(w2_week)          w2_week
               , max(w2_discarded_points_flag)  w2_discard
               , max(w3_points)        w3_points
               , max(w3_week)          w3_week
               , max(w3_discarded_points_flag)  w3_discard
               , max(w4_points)        w4_points
               , max(w4_week)          w4_week
               , max(w4_discarded_points_flag)  w4_discard
               , max(w5_points)        w5_points
               , max(w5_week)          w5_week
               , max(w5_discarded_points_flag)  w5_discard
               , max(w6_points)        w6_points
               , max(w6_week)          w6_week
               , max(w6_discarded_points_flag)  w6_discard
               , max(w7_points)        w7_points
               , max(w7_week)          w7_week
               , max(w7_discarded_points_flag)  w7_discard
               , max(w8_points)        w8_points
               , max(w8_week)          w8_week
               , max(w8_discarded_points_flag)  w8_discard
               , max(w9_points)        w9_points
               , max(w9_week)          w9_week
               , max(w9_discarded_points_flag)  w9_discard
               , max(w10_points)       w10_points
               , max(w10_week)         w10_week
               , max(w10_discarded_points_flag) w10_discard
               , max(w11_points)       w11_points
               , max(w11_week)         w11_week
               , max(w11_discarded_points_flag) w11_discard
               , max(w12_points)       w12_points
               , max(w12_week)         w12_week
               , max(w12_discarded_points_flag) w12_discard
          from (
              select ap.player_id
                   , coalesce(sp.points, p.points) points
                   , p.discarded_points_flag
                   , ap.round_num
                   , coalesce(sp.week, ap.week) week
                   , ap.session_date
          --         , sum(case when p.discarded_points_flag = 'Y' then 0 else p.points end) season_total
              from wmg_tournament_players p
                 , all_tournament_players ap
                 , wmg_tournament_session_points_v sp
              where ap.player_id = p.player_id(+)
                and ap.tournament_session_id = p.tournament_session_id (+)
                and ap.week = sp.week (+)
                and ap.player_id = sp.player_id (+)
                and sp.week (+) = :P60_WEEK
              order by ap.session_date
          )
          pivot (
              any_value(round_num)    round_num
            , any_value(week)         week
            , any_value(session_date) session_date
            , any_value(points)       points
            , any_value(discarded_points_flag) discarded_points_flag
            for round_num in (
                1 as W1
              , 2 as W2
              , 3 as W3
              , 4 as W4
              , 5 as W5
              , 6 as W6
              , 7 as W7
              , 8 as W8
              , 9 as W9
              , 10 as W10
              , 11 as W11
              , 12 as W12
            )
          )
          group by player_id
      )
      , final as (
      select rank() over (order by r.season_total desc) pos
           , r.player_id
           , r.player_name
           , r.country_code
           , r.season_total
           , r.rank_name
           , r.rank_list_class
           , r.w1_points
           , r.w2_points
           , r.w3_points
           , r.w4_points
           , r.w5_points
           , r.w6_points
           , r.w7_points
           , r.w8_points
           , r.w9_points
           , r.w10_points
           , r.w11_points
           , r.w12_points
           , r.w1_discard
           , r.w2_discard
           , r.w3_discard
           , r.w4_discard
           , r.w5_discard
           , r.w6_discard
           , r.w7_discard
           , r.w8_discard
           , r.w9_discard
           , r.w10_discard
           , r.w11_discard
           , r.w12_discard
           , r.w1_week
           , r.w2_week
           , r.w3_week
           , r.w4_week
           , r.w5_week
           , r.w6_week
           , r.w7_week
           , r.w8_week
           , r.w9_week
           , r.w10_week
           , r.w11_week
           , r.w12_week
           , decode(r.player_id, :G_PLAYER_ID, 'mark', '') selected_player
        from (
        select nvl(p.name, p.account) player_name
             , p.country_code
             , p.rank_name
             , p.rank_list_class
             , decode(sp.w1_discard, 'Y', 0, nvl(sp.w1_points,0))
             + decode(sp.w2_discard, 'Y', 0, nvl(sp.w2_points,0))
             + decode(sp.w3_discard, 'Y', 0, nvl(sp.w3_points,0))
             + decode(sp.w4_discard, 'Y', 0, nvl(sp.w4_points,0))
             + decode(sp.w5_discard, 'Y', 0, nvl(sp.w5_points,0))
             + decode(sp.w6_discard, 'Y', 0, nvl(sp.w6_points,0))
             + decode(sp.w7_discard, 'Y', 0, nvl(sp.w7_points,0))
             + decode(sp.w8_discard, 'Y', 0, nvl(sp.w8_points,0))
             + decode(sp.w9_discard, 'Y', 0, nvl(sp.w9_points,0))
             + decode(sp.w10_discard, 'Y', 0, nvl(sp.w10_points,0))
             + decode(sp.w11_discard, 'Y', 0, nvl(sp.w11_points,0))
             + decode(sp.w12_discard, 'Y', 0, nvl(sp.w12_points,0)) season_total
           , sp.*
        from sessions_pivot sp
           , wmg_players_v p
        where p.id = sp.player_id
      ) r
      )
      , me as (
          select nvl(max(player_id),-1) me_player_id, nvl(max(pos),0) my_pos
            from final
           where player_id = :G_PLAYER_ID
      )
      select f.*
      from final f
      , me
      where (:P60_ONLY_ME_IND = 'N' 
        or (me.me_player_id = -1 or (f.pos between greatest((me.my_pos - 4),1) and (me.my_pos + 4)))
        )
      order by 5 desc
      
    page-items-to-submit: 
    - P60_TOURNAMENT_ID
    - P60_WEEK
    - P60_ONLY_ME_IND

  layout: 
    sequence: 35
    parent-region: No Parent
    position: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: Automatic
    column-css-classes: 
    - col-xs-12
    - col-sm-12
    - col-md-12
    - col-lg-7

  appearance: 
    template: Standard # 46986580184360702438
    template-options: 
    - '#DEFAULT#'
    - t-Region--noPadding
    - js-showMaximizeButton
    - t-Region--showIcon
    - t-Region--scrollBody
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: raceRegion
    region-display-selector: false
    exclude-title-from-translation: false

  header-and-footer: 
    header-text: |
      <div class="pro-legend row margin-sm u-justify-content-space-around">
      <div class="-wm-rank-pro fa margin-right-sm" title="Pro"> = Pro player</div>
      <div class="-wm-rank-semi fa margin-right-sm" title="Semi-Pro"> = Semi Pro player</div>
      <div class="-wm-rank-new fa margin-right-sm" title="Amateur"> = Amateur player</div>
      </div>

  server-side-condition: 
    type: Rows returned
    sql-query: |
      select 1
      from wmg_tournament_players
      where tournament_session_id in (
          select id
          from wmg_tournament_sessions
          where week = :P60_WEEK
      )
      union
        select 1
          from wmg_tournaments
         where current_flag = 'Y'
           and id in (
          select tournament_id
            from wmg_tournament_sessions
          where week = :P60_WEEK
      )

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    layout: 
      number-of-rows-type: Static Value
      number-of-rows: 250

    appearance: 
      template-type: Theme
      template: Standard # 46986618016296702453
      template-options: 
      - '#DEFAULT#'
      - t-Report--staticRowColors
      - t-Report--rowHighlightOff
      - t-Report--verticalBorders
      - t-Report--hideNoPagination

    pagination: 
      type: Row Ranges X to Y of Z (no pagination)
      display-position: Bottom - Right
      partial-page-refresh: true

    performance: 
      lazy-loading: false

    messages: 
      when-no-data-found: '- No scores yet -'

    break-formatting: 
      break-columns: No Break

    advanced: 
      strip-html: false
      sort-nulls: Last

    heading: 
      type: PL/SQL Function Body
      pl/sql-function-body: |
        declare 
          l_headings varchar2(32767);
        begin
        
        select listagg('W' || round_num ||'<br>'|| to_char(session_date, 'MM/DD'), ':') within group (order by session_date)
        into l_headings
        from (
            select ts.tournament_id
                 , ts.round_num
                 , ts.week
                 , ts.session_date
            from wmg_tournament_sessions ts
            where ts.tournament_id = :P60_TOURNAMENT_ID
        );
        
          return  'Edit:Rank:<i class="fa fa-flag-o"></i>:Player:Season<br>Total:' || l_headings;
        end;
         
        

    download: 
      csv-export-enabled: false

    printing: 
      enabled: false

  columns: 
  - # ====== Column: PLAYER_NAME =================================
    id: 4008524835738102
    identification: 
      column-name: PLAYER_NAME
      type: Link

    heading: 
      heading: Player
      alignment: center

    layout: 
      sequence: 40
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    link: 
      target: 
        url: 'f?p=&APP_ID.:120:&SESSION.::&DEBUG.:120:P120_PLAYER_ID,P120_TOURNAMENT_ID:#PLAYER_ID#,&P60_TOURNAMENT_ID.'
        page: 120 # Player Profile
        clear-cache: 120
        values: 
          p120_player_id: '#PLAYER_ID#'
          p120_tournament_id: '&P60_TOURNAMENT_ID.'

      link-text: '#PLAYER_NAME# <div class="w #RANK_LIST_CLASS#" title="#RANK_NAME#"></div>'

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COUNTRY_CODE ================================
    id: 4009195466738109
    identification: 
      column-name: COUNTRY_CODE
      type: Plain Text

    heading: 
      heading: <i class="fa fa-flag-o"></i>
      alignment: center

    layout: 
      sequence: 30
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: '<i class="em em-flag-#COUNTRY_CODE#" aria-label="Flag #COUNTRY_CODE#"></i>'

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W1_POINTS ===================================
    id: 6010103427197108
    identification: 
      column-name: W1_POINTS
      type: Plain Text

    heading: 
      heading: W1 Points
      alignment: center

    layout: 
      sequence: 60
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W1_WEEK# discard#W1_DISCARD#">#W1_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W2_POINTS ===================================
    id: 6010569268197112
    identification: 
      column-name: W2_POINTS
      type: Plain Text

    heading: 
      heading: W2 Points
      alignment: center

    layout: 
      sequence: 70
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W2_WEEK# discard#W2_DISCARD#">#W2_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 2

    security: 
      escape-special-characters: true

  - # ====== Column: W3_POINTS ===================================
    id: 6010904877197116
    identification: 
      column-name: W3_POINTS
      type: Plain Text

    heading: 
      heading: W3 Points
      alignment: center

    layout: 
      sequence: 80
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W3_WEEK# discard#W3_DISCARD#">#W3_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 3

    security: 
      escape-special-characters: true

  - # ====== Column: W4_POINTS ===================================
    id: 6011332026197120
    identification: 
      column-name: W4_POINTS
      type: Plain Text

    heading: 
      heading: W4 Points
      alignment: center

    layout: 
      sequence: 90
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W4_WEEK# discard#W4_DISCARD#">#W4_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 4

    security: 
      escape-special-characters: true

  - # ====== Column: W5_POINTS ===================================
    id: 7606033475066874
    identification: 
      column-name: W5_POINTS
      type: Plain Text

    heading: 
      heading: W5 Points
      alignment: center

    layout: 
      sequence: 100
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W5_WEEK# discard#W5_DISCARD#">#W5_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 5

    security: 
      escape-special-characters: true

  - # ====== Column: POS =========================================
    id: 7606396955066878
    identification: 
      column-name: POS
      type: Plain Text

    heading: 
      heading: Rank
      alignment: center

    layout: 
      sequence: 20
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#SELECTED_PLAYER#">#POS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: SEASON_TOTAL ================================
    id: 7606570538066879
    identification: 
      column-name: SEASON_TOTAL
      type: Plain Text

    heading: 
      heading: Season Total
      alignment: center

    layout: 
      sequence: 50
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W6_POINTS ===================================
    id: 7606581763066880
    identification: 
      column-name: W6_POINTS
      type: Plain Text

    heading: 
      heading: W6 Points
      alignment: center

    layout: 
      sequence: 110
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W6_WEEK# discard#W6_DISCARD#">#W6_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 6

    security: 
      escape-special-characters: true

  - # ====== Column: W7_POINTS ===================================
    id: 7606739235066881
    identification: 
      column-name: W7_POINTS
      type: Plain Text

    heading: 
      heading: W7 Points
      alignment: center

    layout: 
      sequence: 120
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W7_WEEK# discard#W7_DISCARD#">#W7_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 7

    security: 
      escape-special-characters: true

  - # ====== Column: W8_POINTS ===================================
    id: 7606808504066882
    identification: 
      column-name: W8_POINTS
      type: Plain Text

    heading: 
      heading: W8 Points
      alignment: center

    layout: 
      sequence: 130
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W8_WEEK# discard#W8_DISCARD#">#W8_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 8

    security: 
      escape-special-characters: true

  - # ====== Column: W9_POINTS ===================================
    id: 7606942304066883
    identification: 
      column-name: W9_POINTS
      type: Plain Text

    heading: 
      heading: W9 Points
      alignment: center

    layout: 
      sequence: 140
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W9_WEEK# discard#W9_DISCARD#">#W9_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 9

    security: 
      escape-special-characters: true

  - # ====== Column: W10_POINTS ==================================
    id: 7607003136066884
    identification: 
      column-name: W10_POINTS
      type: Plain Text

    heading: 
      heading: W10 Points
      alignment: center

    layout: 
      sequence: 150
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W10_WEEK# discard#W10_DISCARD#">#W10_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 10

    security: 
      escape-special-characters: true

  - # ====== Column: W11_POINTS ==================================
    id: 7607116903066885
    identification: 
      column-name: W11_POINTS
      type: Plain Text

    heading: 
      heading: W11 Points
      alignment: center

    layout: 
      sequence: 160
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W11_WEEK# discard#W11_DISCARD#">#W11_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 11

    security: 
      escape-special-characters: true

  - # ====== Column: W12_POINTS ==================================
    id: 7607268166066886
    identification: 
      column-name: W12_POINTS
      type: Plain Text

    heading: 
      heading: W12 Points
      alignment: center

    layout: 
      sequence: 170
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#W12_WEEK# discard#W12_DISCARD#">#W12_POINTS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    server-side-condition: 
      type: Rows returned
      sql-query: |
        select 1
        from wmg_tournament_sessions ts
        where ts.tournament_id = :P60_TOURNAMENT_ID
        and ts.round_num = 12

    security: 
      escape-special-characters: true

  - # ====== Column: PLAYER_ID ===================================
    id: 7607463446066888
    identification: 
      column-name: PLAYER_ID
      type: Link

    heading: 
      heading: Edit
      alignment: center

    layout: 
      sequence: 10
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    link: 
      target: 
        url: 'f?p=&APP_ID.:130:&SESSION.::&DEBUG.::P130_PLAYER_ID:#PLAYER_ID#'
        page: 130 # Player Tournament Details
        values: 
          p130_player_id: '#PLAYER_ID#'

      link-text: '&EDIT_BUTTON.'

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      authorization-scheme: Tournament Admin # 55893512303411682019
      escape-special-characters: true

  - # ====== Column: W1_DISCARD ==================================
    id: 7607679641066891
    identification: 
      column-name: W1_DISCARD
      type: Hidden Column

    layout: 
      sequence: 190

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W2_DISCARD ==================================
    id: 7607786709066892
    identification: 
      column-name: W2_DISCARD
      type: Hidden Column

    layout: 
      sequence: 200

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W3_DISCARD ==================================
    id: 7607936227066893
    identification: 
      column-name: W3_DISCARD
      type: Hidden Column

    layout: 
      sequence: 210

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W4_DISCARD ==================================
    id: 7608051293066894
    identification: 
      column-name: W4_DISCARD
      type: Hidden Column

    layout: 
      sequence: 220

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W5_DISCARD ==================================
    id: 7608173142066895
    identification: 
      column-name: W5_DISCARD
      type: Hidden Column

    layout: 
      sequence: 230

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W6_DISCARD ==================================
    id: 7608211105066896
    identification: 
      column-name: W6_DISCARD
      type: Hidden Column

    layout: 
      sequence: 240

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W7_DISCARD ==================================
    id: 7608282258066897
    identification: 
      column-name: W7_DISCARD
      type: Hidden Column

    layout: 
      sequence: 250

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W8_DISCARD ==================================
    id: 7608420840066898
    identification: 
      column-name: W8_DISCARD
      type: Hidden Column

    layout: 
      sequence: 260

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W9_DISCARD ==================================
    id: 7608498871066899
    identification: 
      column-name: W9_DISCARD
      type: Hidden Column

    layout: 
      sequence: 270

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W10_DISCARD =================================
    id: 7608621886066900
    identification: 
      column-name: W10_DISCARD
      type: Hidden Column

    layout: 
      sequence: 280

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W11_DISCARD =================================
    id: 7608747890066901
    identification: 
      column-name: W11_DISCARD
      type: Hidden Column

    layout: 
      sequence: 290

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W12_DISCARD =================================
    id: 7608802771066902
    identification: 
      column-name: W12_DISCARD
      type: Hidden Column

    layout: 
      sequence: 300

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W1_WEEK =====================================
    id: 8207757126109884
    identification: 
      column-name: W1_WEEK
      type: Hidden Column

    layout: 
      sequence: 310

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W2_WEEK =====================================
    id: 8207863378109885
    identification: 
      column-name: W2_WEEK
      type: Hidden Column

    layout: 
      sequence: 320

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W3_WEEK =====================================
    id: 8207950151109886
    identification: 
      column-name: W3_WEEK
      type: Hidden Column

    layout: 
      sequence: 330

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W4_WEEK =====================================
    id: 8207992278109887
    identification: 
      column-name: W4_WEEK
      type: Hidden Column

    layout: 
      sequence: 340

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W5_WEEK =====================================
    id: 8208167467109888
    identification: 
      column-name: W5_WEEK
      type: Hidden Column

    layout: 
      sequence: 350

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W6_WEEK =====================================
    id: 8208247191109889
    identification: 
      column-name: W6_WEEK
      type: Hidden Column

    layout: 
      sequence: 360

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W7_WEEK =====================================
    id: 8208290928109890
    identification: 
      column-name: W7_WEEK
      type: Hidden Column

    layout: 
      sequence: 370

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W8_WEEK =====================================
    id: 8208459203109891
    identification: 
      column-name: W8_WEEK
      type: Hidden Column

    layout: 
      sequence: 380

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W9_WEEK =====================================
    id: 8208530835109892
    identification: 
      column-name: W9_WEEK
      type: Hidden Column

    layout: 
      sequence: 390

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W10_WEEK ====================================
    id: 8208659380109893
    identification: 
      column-name: W10_WEEK
      type: Hidden Column

    layout: 
      sequence: 400

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W11_WEEK ====================================
    id: 8208698147109894
    identification: 
      column-name: W11_WEEK
      type: Hidden Column

    layout: 
      sequence: 410

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: W12_WEEK ====================================
    id: 8208782263109895
    identification: 
      column-name: W12_WEEK
      type: Hidden Column

    layout: 
      sequence: 420

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: SELECTED_PLAYER =============================
    id: 8209202845109899
    identification: 
      column-name: SELECTED_PLAYER
      type: Hidden Column

    layout: 
      sequence: 430

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: RANK_LIST_CLASS =============================
    id: 24233533450737306
    identification: 
      column-name: RANK_LIST_CLASS
      type: Hidden Column

    layout: 
      sequence: 450

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: RANK_NAME ===================================
    id: 24233576692737307
    identification: 
      column-name: RANK_NAME
      type: Hidden Column

    layout: 
      sequence: 460

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

- # ====== Region: {col1} ======================================
  id: 27803537185823173
  identification: 
    title: '{col1}'
    type: Static Content

  layout: 
    sequence: 25
    parent-region: No Parent
    position: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 4
    column-css-classes: 
    - col-xs-12
    - col-sm-12
    - col-md-12
    - col-lg-5

  appearance: 
    template: Blank with Attributes # 46986519704134702414
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: true
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Badge Key ===================================
  id: 49947472084599132
  identification: 
    title: Badge Key
    type: Classic Report

  source: 
    location: Local Database
    type: Table / View
    table-owner: Parsing Schema
    table-name: WMG_BADGE_TYPES
    include-rowid-column: false
    where-clause: selectable_ind = 'Y'

  order-by: 
    type: Static Value
    order-by-clause: DISPLAY_SEQ

  layout: 
    sequence: 10
    parent-region: '{col1}' # 27803537185823173
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard # 46986580184360702438
    template-options: 
    - '#DEFAULT#'
    - t-Region--noBorder
    - js-headingLevel-3
    - t-Region--scrollBody
    - t-Form--slimPadding
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: badgeKey
    region-display-selector: false
    exclude-title-from-translation: false

  header-and-footer: 
    footer-text: '"BADGES_BY_STEVEN"'

  server-cache: 
    caching: Enabled
    cache-timeout: 2 weeks
    depends-on-item(s): 
    - APP_REQUEST_DATA_HASH

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    layout: 
      number-of-rows-type: Static Value
      number-of-rows: 15

    appearance: 
      template-type: Theme
      template: Standard # 46986618016296702453
      template-options: 
      - '#DEFAULT#'
      - t-Report--stretch
      - t-Report--staticRowColors
      - t-Report--rowHighlightOff
      - t-Report--noBorders

    pagination: 
      type: No Pagination (Show All Rows)
      partial-page-refresh: true

    performance: 
      lazy-loading: false

    break-formatting: 
      break-columns: No Break

    advanced: 
      strip-html: false
      sort-nulls: Last

    heading: 
      type: None

    download: 
      csv-export-enabled: false

    printing: 
      enabled: false

  columns: 
  - # ====== Column: ID ==========================================
    id: 27817643126911110
    identification: 
      column-name: ID
      type: Hidden Column

    layout: 
      sequence: 10

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: CODE ========================================
    id: 27818009796911111
    identification: 
      column-name: CODE
      type: Hidden Column

    layout: 
      sequence: 20

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: NAME ========================================
    id: 27818435810911112
    identification: 
      column-name: NAME
      type: Plain Text

    heading: 
      heading: Badge
      alignment: center

    layout: 
      sequence: 30
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: '<i class="#ICON_CLASS#" title="#NAME#"></i> <b>#NAME#</b>: #DESCRIPTION#'

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: DISPLAY_SEQ =================================
    id: 27818835856911112
    identification: 
      column-name: DISPLAY_SEQ
      type: Hidden Column

    layout: 
      sequence: 40

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: DESCRIPTION =================================
    id: 27819196273911113
    identification: 
      column-name: DESCRIPTION
      type: Hidden Column

    layout: 
      sequence: 50

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: ICON_CLASS ==================================
    id: 27819628229911114
    identification: 
      column-name: ICON_CLASS
      type: Hidden Column

    layout: 
      sequence: 60

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: ACTIVE_IND ==================================
    id: 27820009719911114
    identification: 
      column-name: ACTIVE_IND
      type: Hidden Column

    layout: 
      sequence: 70

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: CREATED_ON ==================================
    id: 27820428854911115
    identification: 
      column-name: CREATED_ON
      type: Hidden Column

    layout: 
      sequence: 80

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: CREATED_BY ==================================
    id: 27820851592911116
    identification: 
      column-name: CREATED_BY
      type: Hidden Column

    layout: 
      sequence: 90

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: UPDATED_ON ==================================
    id: 27821243460911116
    identification: 
      column-name: UPDATED_ON
      type: Hidden Column

    layout: 
      sequence: 100

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: UPDATED_BY ==================================
    id: 27821630242911117
    identification: 
      column-name: UPDATED_BY
      type: Hidden Column

    layout: 
      sequence: 110

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

- # ====== Region: Most h1n Current Season =====================
  id: 24454464806256734671
  identification: 
    title: Most h1n Current Season
    type: Classic Report

  source: 
    location: Local Database
    type: SQL Query
    sql-query: |
      select r.*, rank() over (order by r.hn1 desc) pos
      from (
          select substr(r.week,1,3) season
           , p.player_name
           , sum(r.score) hn1
        from wmg_rounds_unpivot_mv r
           , wmg_players_v p
           , wmg_courses_v c
      where r.player_id = p.id
      and c.course_id = r.course_id
      and r.score = 1
       and r.week like ( select prefix_tournament from wmg_tournaments where current_flag = 'Y')
      group by substr(r.week,1,3)
             , p.player_name
      order by 3 desc
      ) r
      

  layout: 
    sequence: 20
    parent-region: Other Results # 108296151279429485789
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard # 46986580184360702438
    template-options: 
    - '#DEFAULT#'
    - t-Region--scrollBody
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    layout: 
      number-of-rows-type: Static Value
      number-of-rows: 10

    appearance: 
      template-type: Theme
      template: Standard # 46986618016296702453
      template-options: 
      - '#DEFAULT#'
      - t-Report--stretch
      - t-Report--altRowsDefault
      - t-Report--rowHighlight

    pagination: 
      type: Row Ranges X to Y (with next and previous links)
      display-position: Bottom - Right
      partial-page-refresh: true

    performance: 
      lazy-loading: false

    break-formatting: 
      break-columns: No Break

    advanced: 
      strip-html: false
      sort-nulls: Last

    heading: 
      type: Custom Headings

    download: 
      csv-export-enabled: false

    printing: 
      enabled: false

  columns: 
  - # ====== Column: SEASON ======================================
    id: 3562267189798417
    identification: 
      column-name: SEASON
      type: Plain Text

    heading: 
      heading: Season
      alignment: center

    layout: 
      sequence: 30
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: HN1 =========================================
    id: 3563004705798418
    identification: 
      column-name: HN1
      type: Plain Text

    heading: 
      heading: Hn1
      alignment: center

    layout: 
      sequence: 50
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: POS =========================================
    id: 3563418929798419
    identification: 
      column-name: POS
      type: Plain Text

    heading: 
      heading: Pos
      alignment: center

    layout: 
      sequence: 10
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: true

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: PLAYER_NAME =================================
    id: 27806857191823206
    identification: 
      column-name: PLAYER_NAME
      type: Plain Text

    heading: 
      heading: Player Name
      alignment: center

    layout: 
      sequence: 40
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: true

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

- # ====== Region: Most h1n Over the last &P60_TOTAL_WEEKS. week
  id: 24454469853035807099
  identification: 
    title: Most h1n Over the last &P60_TOTAL_WEEKS. weeks
    type: Classic Report

  source: 
    location: Local Database
    type: SQL Query
    sql-query: |
      select r.*, rank() over (order by r.hn1 desc) pos
      from (
      select p.player_name
           , sum(r.score) hn1
        from wmg_rounds_unpivot_mv r
           , wmg_players_v p
           , wmg_courses_v c
      where r.player_id = p.id
      and c.course_id = r.course_id
      and r.score = 1
      -- r.week like 'S07%'
      group by p.player_name
      order by 2 desc
      ) r

  layout: 
    sequence: 20
    parent-region: Other Results # 108296151279429485789
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard # 46986580184360702438
    template-options: 
    - '#DEFAULT#'
    - t-Region--scrollBody
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    layout: 
      number-of-rows-type: Static Value
      number-of-rows: 10

    appearance: 
      template-type: Theme
      template: Standard # 46986618016296702453
      template-options: 
      - '#DEFAULT#'
      - t-Report--stretch
      - t-Report--altRowsDefault
      - t-Report--rowHighlight

    pagination: 
      type: Row Ranges X to Y (with next and previous links)
      display-position: Bottom - Right
      partial-page-refresh: true

    performance: 
      lazy-loading: false

    break-formatting: 
      break-columns: No Break

    advanced: 
      strip-html: false
      sort-nulls: Last

    heading: 
      type: Custom Headings

    download: 
      csv-export-enabled: false

    printing: 
      enabled: false

  columns: 
  - # ====== Column: HN1 =========================================
    id: 3567094941870832
    identification: 
      column-name: HN1
      type: Plain Text

    heading: 
      heading: Hn1
      alignment: center

    layout: 
      sequence: 30
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: POS =========================================
    id: 3567489763870832
    identification: 
      column-name: POS
      type: Plain Text

    heading: 
      heading: Pos
      alignment: center

    layout: 
      sequence: 10
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: true

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: PLAYER_NAME =================================
    id: 27806880618823207
    identification: 
      column-name: PLAYER_NAME
      type: Plain Text

    heading: 
      heading: Player Name
      alignment: center

    layout: 
      sequence: 20
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: true

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

- # ====== Region: {items} =====================================
  id: 106623657478402405520
  identification: 
    title: '{items}'
    type: Static Content

  layout: 
    sequence: 5
    parent-region: No Parent
    position: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Blank with Attributes # 46986519704134702414
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: itemsRegion
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Week Results (&P60_WEEK.) ===================
  id: 108296150341164485780
  identification: 
    title: Week Results (&P60_WEEK.)
    type: Classic Report

  source: 
    location: Local Database
    type: SQL Query
    sql-query: |
      with coconut as (
          select u.week
               , u.player_id, sum(case when par <= 0 then 1 else 0 end) under_par
               , sum(case when score = 1 then 1 else 0 end) hn1_count
            from wmg_rounds_unpivot_mv u
               , wmg_tournament_sessions ts
           where ts.week = u.week
             and u.week = :P60_WEEK
             and ts.completed_ind = 'N'  -- only live results
           having sum(case when par <= 0 then 1 else 0 end) = 36
           group by u.week, u.player_id
      )
      , cactus as (
           select player_id, count(*) n
            from (
            select u.course_id || ':' || u.h h, u.score, any_value(u.player_id) player_id
              from wmg_rounds_unpivot_mv u
                 , wmg_tournament_sessions ts
             where ts.week = u.week
               and u.week = :P60_WEEK
               and ts.completed_ind = 'N' -- only live results
               and u.score = 1
            having count(*) = 1
             group by u.course_id || ':' || u.h, u.score
           )
           group by player_id
      )
      , badges as (
       select p.tournament_session_id, p.player_id
              -- need to expand by the badge_count, because people can habe multiple-badges
            , listagg( (select listagg(replace(b.icon_class, 'em em', 'em'), ' ') from dual connect by level <= p.badge_count) , ' ')  within group ( order by b.display_seq) other_badges
            , json_objectagg(key p.badge_type_code value case when p.badge_count>=1 then 'true' else 'false' end) badge_json
        from wmg_player_badges p
           , wmg_badge_types b
        where p.badge_type_code = b.code
          and p.tournament_session_id = :P60_TOURNAMENT_SESSION_ID
          and b.selectable_ind = 'Y'
        group by p.tournament_session_id, p.player_id
      )
      , me as (
          select nvl(max(player_id),-1) player_id, nvl(max(pos),0) pos
            from wmg_tournament_session_points_v
           where week = :P60_WEEK
             and player_id = :G_PLAYER_ID
      )
      select p.pos
           , p.player_id
           , p.country_code
           , p.player_name
           , p.easy
           , p.hard
           , p.total_score
           , p.points
           , case when p.pos <= 10 then 'top' else 'p' || to_char(p.points) end point_class
           , decode(p.player_id, :G_PLAYER_ID, 'mark', '') selected_player
           , case when p.pos = 1 then '<i class="em em-trophy" aria-role="presentation" aria-label="TROPHY"></i>' else '' end trophy
           , case when p.completed_ind = 'N' then
               case p.pos 
               when 1 then 'em-first_place_medal '
               when 2 then 'em-second_place_medal '
               when 3 then 'em-third_place_medal '
               end
             end
          || decode(coconut.under_par, 36, 'em-coconut' || decode(cactus.player_id, null, '', ' '), '') 
          || decode(cactus.player_id, null, null, (select listagg('em-cactus', ' ') from dual connect by level <= cactus.n) ) 
          || ' ' || other_badges badges
           , nvl(badges.badge_json, '{}') badge_json
           , '' badges_menu
      from wmg_tournament_session_points_v p
      , coconut
      , cactus
      , badges
      , me
      where p.week = :P60_WEEK
        and p.player_id = coconut.player_id (+)
        and p.player_id = cactus.player_id (+)
        and p.player_id = badges.player_id (+)
        and (:P60_ONLY_ME_IND = 'N' 
          or (me.player_id = -1 or (p.pos between greatest((me.pos - 2),1) and (me.pos + 3)))
        )
      order by p.pos
      
    page-items-to-submit: 
    - P60_WEEK
    - P60_TOURNAMENT_SESSION_ID
    - P60_ONLY_ME_IND
    optimizer-hint: WITH_PLSQL

  layout: 
    sequence: 20
    parent-region: '{col1}' # 27803537185823173
    position: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard # 46986580184360702438
    template-options: 
    - '#DEFAULT#'
    - t-Region--noPadding
    - js-showMaximizeButton
    - t-Region--scrollBody
    - margin-left-none
    - margin-right-none
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: weekResults
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    layout: 
      number-of-rows-type: Static Value
      number-of-rows: 250

    appearance: 
      template-type: Theme
      template: Standard # 46986618016296702453
      template-options: 
      - '#DEFAULT#'
      - t-Report--stretch
      - t-Report--altRowsDefault
      - t-Report--rowHighlightOff
      - t-Report--verticalBorders
      - t-Report--hideNoPagination

    pagination: 
      type: Row Ranges X to Y of Z (no pagination)
      display-position: Bottom - Right
      partial-page-refresh: true

    performance: 
      lazy-loading: false

    messages: 
      when-no-data-found: '- No scores yet -'

    break-formatting: 
      break-columns: No Break

    advanced: 
      strip-html: false
      sort-nulls: Last

    heading: 
      type: Custom Headings

    download: 
      csv-export-enabled: false

    printing: 
      enabled: false

  columns: 
  - # ====== Column: COUNTRY_CODE ================================
    id: 610831107572885
    identification: 
      column-name: COUNTRY_CODE
      type: Plain Text

    heading: 
      heading: <span aria-hidden="true" class="fa fa-flag-o"></span>
      alignment: center

    layout: 
      sequence: 40
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: '<i class="em em-flag-#COUNTRY_CODE#" aria-role="presentation" aria-label="Flag #COUNTRY_CODE#" title="#COUNTRY_CODE#"></i>'

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: SELECTED_PLAYER =============================
    id: 4007494937738092
    identification: 
      column-name: SELECTED_PLAYER
      type: Hidden Column

    layout: 
      sequence: 110

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: TROPHY ======================================
    id: 8209299438109900
    identification: 
      column-name: TROPHY
      type: Hidden Column

    layout: 
      sequence: 120

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: false

  - # ====== Column: BADGES ======================================
    id: 27803587770823174
    identification: 
      column-name: BADGES
      type: Plain Text

    heading: 
      heading: Badges
      alignment: center

    layout: 
      sequence: 130
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: |
        {loop " " BADGES/}
        <i class="em &APEX$ITEM." aria-role="presentation" aria-label="&APEX$ITEM."></i>
        {endloop/}

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: BADGES_MENU =================================
    id: 27803948319823177
    identification: 
      column-name: BADGES_MENU
      type: Plain Text

    heading: 
      heading: Add Badges
      alignment: center

    layout: 
      sequence: 140
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: |
        <button type="button" class="t-Button t-Button--icon t-Button--noLabel t-Button--tiny t-Button--stretch js-menuButton" data-menu="badge_list_menu" aria-label="Badges" title="Badges" data-id="#PLAYER_ID#" data-link="" data-title="Badges" aria-haspopup="menu"
        data-badges=#BADGE_JSON#>
        <span aria-hidden="true" class="fa fa-badges"></span>
        <span aria-hidden="true" class="fa fa-chevron-down"></span>
        </button>
        

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      authorization-scheme: Contribution Rights # 46986682878463702496
      escape-special-characters: true

  - # ====== Column: BADGE_JSON ==================================
    id: 27804196861823180
    identification: 
      column-name: BADGE_JSON
      type: Hidden Column

    layout: 
      sequence: 150

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: POINT_CLASS =================================
    id: 2316752978009093644
    identification: 
      column-name: POINT_CLASS
      type: Hidden Column

    layout: 
      sequence: 100

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: EASY ========================================
    id: 56015646459290939744
    identification: 
      column-name: EASY
      type: Plain Text

    heading: 
      heading: Easy
      alignment: center

    layout: 
      sequence: 60
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: HARD ========================================
    id: 56015646566524939745
    identification: 
      column-name: HARD
      type: Plain Text

    heading: 
      heading: Hard
      alignment: center

    layout: 
      sequence: 70
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: POINTS ======================================
    id: 56015646844134939748
    identification: 
      column-name: POINTS
      type: Plain Text

    heading: 
      heading: Points
      alignment: center

    layout: 
      sequence: 90
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: '<span class="points #POINT_CLASS#">#POINTS#</span>'

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: TOTAL_SCORE =================================
    id: 58990500980275709187
    identification: 
      column-name: TOTAL_SCORE
      type: Plain Text

    heading: 
      heading: Total
      alignment: center

    layout: 
      sequence: 80
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: PLAYER_NAME =================================
    id: 58990501368565709188
    identification: 
      column-name: PLAYER_NAME
      type: Link

    heading: 
      heading: Player
      alignment: center

    layout: 
      sequence: 50
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    link: 
      target: 
        url: 'f?p=&APP_ID.:110:&SESSION.::&DEBUG.:110:P110_WEEK,P110_PLAYER_ID:&P60_WEEK.,#PLAYER_ID#'
        page: 110 # Player Round Details
        clear-cache: 110
        values: 
          p110_week: '&P60_WEEK.'
          p110_player_id: '#PLAYER_ID#'

      link-text: '#PLAYER_NAME# <div class="w">#TROPHY#</div>'

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: POS =========================================
    id: 58990501734129709188
    identification: 
      column-name: POS
      type: Plain Text

    heading: 
      heading: Rank
      alignment: center

    layout: 
      sequence: 20
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    column-formatting: 
      html-expression: <span class="#SELECTED_PLAYER#">#POS#</span>

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: PLAYER_ID ===================================
    id: 58990502191049709188
    identification: 
      column-name: PLAYER_ID
      type: Link

    heading: 
      heading: Edit
      alignment: center

    layout: 
      sequence: 10
      column-alignment: center

    accessibility: 
      value-identifies-row: false

    link: 
      target: 
        url: 'f?p=&APP_ID.:7:&SESSION.::&DEBUG.:7:P7_ID:#PLAYER_ID#'
        page: 7 # Player
        clear-cache: 7
        values: 
          p7_id: '#PLAYER_ID#'

      link-text: '&EDIT_BUTTON.'

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      authorization-scheme: Tournament Admin # 55893512303411682019
      escape-special-characters: true

- # ====== Region: Other Results ===============================
  id: 108296151279429485789
  identification: 
    title: Other Results
    type: Static Content

  layout: 
    sequence: 45
    parent-region: No Parent
    position: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard # 46986580184360702438
    template-options: 
    - '#DEFAULT#'
    - t-Region--noPadding
    - t-Region--scrollBody
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: itemsRegion
    region-display-selector: true
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

page-items: 
- # ====== Page Item: P60_TOTAL_WEEKS ==========================
  id: 3567903596870837
  identification: 
    name: P60_TOTAL_WEEKS
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 10
    region: Most h1n Over the last &P60_TOTAL_WEEKS. weeks # 24454469853035807099
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_TOURNAMENT ===========================
  id: 7607662932066890
  identification: 
    name: P60_TOURNAMENT
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 90
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_TOURNAMENT_ID ========================
  id: 8210419795109911
  identification: 
    name: P60_TOURNAMENT_ID
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 100
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_TOURNAMENT_SESSION_ID ================
  id: 27804004506823178
  identification: 
    name: P60_TOURNAMENT_SESSION_ID
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 110
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_BADGE_ID =============================
  id: 27805946266823197
  identification: 
    name: P60_BADGE_ID
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 120
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_SEARCH ===============================
  id: 27806563684823203
  identification: 
    name: P60_SEARCH
    type: Text Field

  label: 
    label: Player Search
    alignment: Left

  settings: 
    subtype: Search
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 30
    region: '{items}' # 106623657478402405520
    position: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default
    column-css-classes: 
    - col-md-3
    - col-lg-4

  appearance: 
    template: Optional - Floating # 46986650580145702469
    template-options: 
    - '#DEFAULT#'
    icon: fa-search
    width: 30

  validation: 
    value-required: false

  advanced: 
    post-text-: '"CLEAR_BUTTON"'
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_ONLY_ME_IND ==========================
  id: 27807032238823208
  identification: 
    name: P60_ONLY_ME_IND
    type: Switch

  label: 
    label: Find Me?
    alignment: Left

  settings: 
    use-defaults: true

  layout: 
    sequence: 40
    region: '{items}' # 106623657478402405520
    position: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 1
    label-column-span: Page Template Default

  appearance: 
    template: Optional - Floating # 46986650580145702469
    template-options: 
    - '#DEFAULT#'

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  default: 
    type: Static
    static-value: N

  session-state: 
    storage: Per Session (Persistent)

  server-side-condition: 
    type: Item is NOT NULL
    item: G_PLAYER_ID

  security: 
    authorization-scheme: MODEL.LOV.MUST_NOT_BE_PUBLIC_USER
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_NAV_DIRECTION ========================
  id: 29403648433118076
  identification: 
    name: P60_NAV_DIRECTION
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 130
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_NAV_PREV =============================
  id: 29403765276118077
  identification: 
    name: P60_NAV_PREV
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 140
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  default: 
    type: Static
    static-value: show

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_NAV_NEXT =============================
  id: 29403801603118078
  identification: 
    name: P60_NAV_NEXT
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 150
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_WEEK =================================
  id: 58990481012454704231
  identification: 
    name: P60_WEEK
    type: Popup LOV

  label: 
    label: Week
    alignment: Left

  settings: 
    display-as: Inline Popup
    initial-fetch: Automatic
    multiple-values: false
    manual-entry: false
    search-as-you-type: true
    minimum-characters: No minimum (0)

  layout: 
    sequence: 10
    region: '{items}' # 106623657478402405520
    position: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 3
    label-column-span: Page Template Default
    column-css-classes: 
    - col-xss-9
    - col-xs-8
    - col-sm-8
    - col-md-6
    - col-lg-4

  appearance: 
    template: Optional - Floating # 46986650580145702469
    template-options: 
    - '#DEFAULT#'
    css-classes: 
    - '&P60_NAV_PREV.'
    - '&P60_NAV_NEXT.'
    width: 30

  validation: 
    value-required: false

  list-of-values: 
    type: Shared Component
    list-of-values: WEEKS # 41195241672950310216
    display-extra-values: true
    display-null-value: true

  advanced: 
    pre-text: |
      <button class="t-Button t-Button--noLabel t-Button--icon t-Button--iconOnly t-Button--noUI week_nav_btn" aria-expanded="false" aria-controls="weekNav" type="button" title="Prev Week" aria-label="Prev Week" data-nav="prev">
      <span class="t-Icon fa fa-chevron-left" aria-hidden="true"></span>
      </button>
      
    post-text-: |
      <button class="t-Button t-Button--noLabel t-Button--icon t-Button--iconOnly t-Button--noUI week_nav_btn" aria-expanded="false" aria-controls="weekNav" type="button" title="Prev Week" aria-label="Prev Week" data-nav="next">
      <span class="t-Icon fa fa-chevron-right" aria-hidden="true"></span>
      </button>
      
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

  advanced: 
    initialization-javascript-function: |
      function(options) {
          options.display = "list";
      
          options.recordTemplate = (
        '<li data-id="~WEEK.">' +
           '<div class="content-list">' +
              '<div class="week-info-list">' +
                 '<span class="season-name">~SEASON.</span>' +                    
                 '<span class="week-name">Week ~WEEK_NO.</span>' +
                 '<hr>' +
                 '<div class="courses">' +
                   '<span class="easy">~EASY_COURSE.</span>' + ' & ' +
                   '<span class="hard">~HARD_COURSE.</span>' +
                 '</div>' +
              '</div>' +
           '</div>'+
        '</li>').replace(/~/g, "&");
      
          return options;
      }

- # ====== Page Item: P60_TOTAL_PLAYERS ========================
  id: 58990481446347704231
  identification: 
    name: P60_TOTAL_PLAYERS
    type: Display Only

  label: 
    label: Total Players
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 20
    region: '{items}' # 106623657478402405520
    position: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    label-column-span: Page Template Default
    column-css-classes: 
    - col-xss-3
    - col-xs-4
    - col-sm-4
    - col-md-2
    - col-lg-3

  appearance: 
    template: Optional - Floating # 46986650580145702469
    template-options: 
    - '#DEFAULT#'
    css-classes: 
    - u-textCenter

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: SQL Query (return single value)
    sql-query: |
      select count(*)
        from wmg_tournament_players 
       where tournament_session_id = :P60_TOURNAMENT_SESSION_ID
    used: Always, replacing any existing value in session state

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  server-side-condition: 
    type: Item is NOT NULL
    item: P60_WEEK

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_H ====================================
  id: 58990481812299704231
  identification: 
    name: P60_H
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 50
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_MODE =================================
  id: 58990482283542704232
  identification: 
    name: P60_MODE
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 60
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_EASY =================================
  id: 58990482603233704232
  identification: 
    name: P60_EASY
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 70
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: SQL Query (return single value)
    sql-query: |
      select name
          from wmg_courses_v
         where course_id in (
            select distinct course_id
              from wmg_rounds 
             where week = :P60_WEEK 
          )
         and course_mode = 'E'
    used: Always, replacing any existing value in session state

  default: 
    type: Static
    static-value: Easy Course

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P60_HARD =================================
  id: 58990483056463704232
  identification: 
    name: P60_HARD
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 80
    region: '{items}' # 106623657478402405520
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: SQL Query (return single value)
    sql-query: |
      select name
          from wmg_courses_v
         where course_id in (
            select distinct course_id
              from wmg_rounds 
             where week = :P60_WEEK 
          )
         and course_mode = 'H'
    used: Always, replacing any existing value in session state

  default: 
    type: Static
    static-value: Hard Course

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

buttons: 
- # ====== Button: ABOUT =======================================
  id: 207034433006404
  identification: 
    button-name: ABOUT
    label: About the points

  layout: 
    sequence: 10
    region: Week Results (&P60_WEEK.) # 108296150341164485780
    position: EDIT
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text with Icon # 46986653123744702471
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--mobileHideLabel
    - t-Button--iconRight
    icon: fa-question-circle-o

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:20:&SESSION.::&DEBUG.:20:P20_NOTE_TYPE:POINTS'
      page: 20 # About/Rules
      clear-cache: 20
      values: 
        p20_note_type: POINTS

    warn-on-unsaved-changes: Do Not Check

- # ====== Button: VERIFY_RESULTS ==============================
  id: 669502916503521
  identification: 
    button-name: VERIFY_RESULTS
    label: Verify Results

  layout: 
    sequence: 40
    region: Breadcrumb # 58998669373500537434
    position: NEXT
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text with Icon # 46986653123744702471
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--mobileHideLabel
    - t-Button--small
    - t-Button--simple
    - t-Button--iconLeft
    - t-Button--gapTop
    css-classes: 
    - col-xss-3
    - col-xs-3
    icon: fa-exchange

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:70:&SESSION.::&DEBUG.:70:P70_WEEK:&P60_WEEK.'
      page: 70 # Upload Verification Scores
      clear-cache: 70
      values: 
        p70_week: '&P60_WEEK.'

    warn-on-unsaved-changes: Do Not Check

  security: 
    authorization-scheme: Contribution Rights # 46986682878463702496

- # ====== Button: DOWNLOAD ====================================
  id: 24442381510936124331
  identification: 
    button-name: DOWNLOAD
    label: Download Detailed Results

  layout: 
    sequence: 30
    region: Breadcrumb # 58998669373500537434
    position: NEXT
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text with Icon # 46986653123744702471
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--mobileHideLabel
    - t-Button--small
    - t-Button--simple
    - t-Button--iconLeft
    - t-Button--gapTop
    css-classes: 
    - col-xss-3
    - col-xs-3
    icon: fa-download-alt

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:62:&SESSION.::&DEBUG.:62:P62_WEEK:&P60_WEEK.'
      page: 62 # Results Download
      clear-cache: 62
      values: 
        p62_week: '&P60_WEEK.'

    warn-on-unsaved-changes: Do Not Check

  security: 
    authorization-scheme: Contribution Rights # 46986682878463702496

dynamic-actions: 
- # ====== Dynamic Action: Highlight Player ====================
  id: 4007760412738094
  identification: 
    name: Highlight Player

  execution: 
    sequence: 40

  when: 
    event: EVENT.EVENT.FAMEWORK.APEXAFTERREFRESH
    selection-type: Region
    region: Week Results (&P60_WEEK.) # 108296150341164485780

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 4007832325738095
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: $(".mark").parents("tr").addClass("mark")

    execution: 
      sequence: 10
      event: Highlight Player # 4007760412738094
      fire-when-event-result-is: True
      fire-on-initialization: true

- # ====== Dynamic Action: Hoist Week Classes to TD ============
  id: 8208952530109896
  identification: 
    name: Hoist Week Classes to TD

  execution: 
    sequence: 20

  when: 
    event: EVENT.EVENT.FAMEWORK.APEXAFTERREFRESH
    selection-type: Region
    region: Season Race (&P60_TOURNAMENT.) # 4008199353738099

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 8208996280109897
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var c = $v("P60_WEEK");
        
        $("td ." + c).each(
          function(){
            var $el = $(this)
        
            $el.parent("td").addClass(c);
          }
        )

    execution: 
      sequence: 10
      event: Hoist Week Classes to TD # 8208952530109896
      fire-when-event-result-is: True
      fire-on-initialization: true

- # ====== Dynamic Action: Search as we type ===================
  id: 27806580702823204
  identification: 
    name: Search as we type

  execution: 
    sequence: 50

  when: 
    event: EVENT.EVENT.BROWSER.KEYUP
    selection-type: Item(s)
    item(s): 
    - P60_SEARCH

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 27806744551823205
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        // Highlight the search term using markjs.io (and even filter away the non-matching lines)
        // var $ctx=$("#report_table_weekResults .t-Report-cell[headers='PLAYER_NAME']")
        var $ctx=$("#report_table_weekResults .t-Report-cell[headers='PLAYER_NAME'],#report_table_raceRegion .t-Report-cell[headers='PLAYER_NAME']")
          , $other=$("#badgeKey,.pro-legend")
          , term=$v("P60_SEARCH");
        
        
        // Remove previous marked elements and ensure they all show
        $ctx.unmark().parents("tr").show();
        if (apex.theme.mq("(max-width: 768px)")) {
          $other.show();
        }
        
        if (term) {
          // mark the search term and hide everything that didn't get marked
          $ctx.mark(term, {
            separateWordSearch: false,
            diacritics: true,
            done: function() {
              $ctx.not(":has(mark)").parents("tr").hide();
              if ($ctx.find("mark").length > 0 && apex.theme.mq("(max-width: 768px)")) {
                 // if something is found and we're on a small device, hide the other regions
                 $other.hide();
               }
            }
          });
        }
        
        

    execution: 
      sequence: 10
      event: Search as we type # 27806580702823204
      fire-when-event-result-is: True
      fire-on-initialization: true

- # ====== Dynamic Action: Only Me Refresh =====================
  id: 27807081977823209
  identification: 
    name: Only Me Refresh

  execution: 
    sequence: 60

  when: 
    event: EVENT.EVENT.BROWSER.CHANGE
    selection-type: Item(s)
    item(s): 
    - P60_ONLY_ME_IND

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Refresh =====================================
    id: 27807275936823210
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Week Results (&P60_WEEK.) # 108296150341164485780

    execution: 
      sequence: 10
      event: Only Me Refresh # 27807081977823209
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Refresh =====================================
    id: 27807314175823211
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Season Race (&P60_TOURNAMENT.) # 4008199353738099

    execution: 
      sequence: 20
      event: Only Me Refresh # 27807081977823209
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Clear on Change =====================
  id: 27808004357823218
  identification: 
    name: Clear on Change

  execution: 
    sequence: 70

  when: 
    event: EVENT.EVENT.BROWSER.CHANGE
    selection-type: Item(s)
    item(s): 
    - P60_SEARCH

  client-side-condition: 
    type: Item is null
    item: P60_SEARCH

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 27808130189823219
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var $ctx=$("#report_table_weekResults .t-Report-cell[headers='PLAYER_NAME'],#report_table_raceRegion .t-Report-cell[headers='PLAYER_NAME']")
          , $other=$("#badgeKey,.pro-legend");
        
        
        // Remove previous marked elements and ensure they all show
        $ctx.unmark().parents("tr").show();
        if (apex.theme.mq("(max-width: 768px)")) {
          $other.show();
        }
        

    execution: 
      sequence: 10
      event: Clear on Change # 27808004357823218
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Next & Prev Week Navigation =========
  id: 29403290355118073
  identification: 
    name: Next & Prev Week Navigation

  execution: 
    sequence: 80

  when: 
    event: EVENT.EVENT.BROWSER.CLICK
    selection-type: jQuery Selector
    jquery-selector: .week_nav_btn

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Set Value ===================================
    id: 29403473797118074
    identification: 
      action: Set Value

    settings: 
      set-type: SQL Statement
      sql-statement: |
        select decode(:P60_NAV_DIRECTION, 'next', next_week, prev_week)
        from (
        select lag(week) over (partition by tournament_id order by round_num) prev_week
             , id, round_num, week
             , lead(week) over (partition by tournament_id order by round_num) next_week
        from wmg_tournament_sessions
        )
        where week = :P60_WEEK
      items-to-submit: 
      - P60_WEEK
      escape-special-characters: true
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P60_WEEK

    execution: 
      sequence: 20
      event: Next & Prev Week Navigation # 29403290355118073
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Set Value ===================================
    id: 29403508701118075
    identification: 
      action: Set Value

    settings: 
      set-type: JavaScript Expression
      javascript-expression: this.triggeringElement.dataset.nav
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P60_NAV_DIRECTION

    execution: 
      sequence: 10
      event: Next & Prev Week Navigation # 29403290355118073
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Sticky Items ========================
  id: 30282673125641069
  identification: 
    name: Sticky Items

  execution: 
    sequence: 90

  when: 
    event: EVENT.EVENT.BROWSER.READY

  execution: 
    event-scope: Static

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 30282980250641085
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var vRegion$ = $(this.affectedElements[0]);
        vRegion$.stickyWidget();
        // .find('.js-stickyTableHeader')

    affected-elements: 
      selection-type: Region
      region: '{items}' # 106623657478402405520

    execution: 
      sequence: 10
      event: Sticky Items # 30282673125641069
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Hoist Classes to TD =================
  id: 2316753045247093645
  identification: 
    name: Hoist Classes to TD

  execution: 
    sequence: 10

  when: 
    event: EVENT.EVENT.FAMEWORK.APEXAFTERREFRESH
    selection-type: Region
    region: Week Results (&P60_WEEK.) # 108296150341164485780

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 2316753113317093646
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        $("td .points").each(
          function(){
            var $el = $(this),
                c = $el.attr("class");
        
            $el.parent("td").addClass(c);
          }
        )

    execution: 
      sequence: 10
      event: Hoist Classes to TD # 2316753045247093645
      fire-when-event-result-is: True
      fire-on-initialization: true

- # ====== Dynamic Action: Reload on Change ====================
  id: 40380892837518957246
  identification: 
    name: Reload on Change

  execution: 
    sequence: 30

  when: 
    event: EVENT.EVENT.BROWSER.CHANGE
    selection-type: Item(s)
    item(s): 
    - P60_WEEK

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Submit Page =================================
    id: 40380892983400957247
    identification: 
      action: Submit Page

    settings: 
      request-/-button-name: REFRESH
      show-processing: true

    execution: 
      sequence: 10
      event: Reload on Change # 40380892837518957246
      fire-when-event-result-is: True
      fire-on-initialization: false

computations: 
- # ====== Computation: P60_TOTAL_WEEKS ========================
  id: 3472347411873698
  identification: 
    item-name: P60_TOTAL_WEEKS

  execution: 
    sequence: 10
    point: Before Regions

  computation: 
    type: SQL Query (return single value)
    sql-query: |
      select count(distinct week)
      from  wmg_rounds
      

processes: 
- # ====== Process: Init =======================================
  id: 4007472298738091
  identification: 
    name: Init
    type: Execute Code

  source: 
    location: Local Database
    language: PL/SQL
    pl/sql-code: |
      begin
       if :P60_WEEK is null then
          select week
            into :P60_WEEK
            from wmg_tournament_sessions_v
           where tournament_session_id = :G_CURRENT_SESSION_ID;
           :P60_TOURNAMENT_SESSION_ID := :G_CURRENT_SESSION_ID;
       end if;
      
           select tournament_session_id
                , tournament_id
                , prefix_tournament
            into :P60_TOURNAMENT_SESSION_ID
               , :P60_TOURNAMENT_ID
               , :P60_TOURNAMENT
            from wmg_tournament_sessions_v
           where week = :P60_WEEK;
      
           select decode(prev_week, null, 'hide_nav_pre') NAV_PREV
                , decode(next_week, null, 'hide_nav_next') NAV_NEXT
             into :P60_NAV_PREV
                , :P60_NAV_NEXT
              from (
              select lag(week) over (partition by tournament_id order by round_num) prev_week
                   , id, round_num, week
                   , lead(week) over (partition by tournament_id order by round_num) next_week
              from wmg_tournament_sessions
              )
              where week = :P60_WEEK;
      
      exception
      when NO_DATA_FOUND then
       null;
      end;
      
      

  execution: 
    sequence: 10
    point: Before Header
    run-process: Once Per Page Visit (default)

- # ====== Process: BADGES =====================================
  id: 27804086344823179
  identification: 
    name: BADGES
    type: Execute Code

  source: 
    location: Local Database
    language: PL/SQL
    pl/sql-code: |
      declare
        l_badge_rec wmg_player_badges%rowtype;
        l_inc number;
        l_return varchar2(10);
      begin
        l_badge_rec.player_id := to_number(apex_application.g_x02);
        l_badge_rec.badge_type_code := apex_application.g_x03;
        l_badge_rec.tournament_session_id := :P60_TOURNAMENT_SESSION_ID;
      
        if apex_application.g_x01 = 'Add' then
          l_inc := 1;
          l_badge_rec.badge_count := 1;
          l_return := 'ADDED';
        else
          l_inc := -1;
          l_badge_rec.badge_count := 0;
          l_return := 'REMOVED';
        end if;
      
        update wmg_player_badges
           set badge_count = case when l_inc = -1 then least(0, badge_count + l_inc) else badge_count + l_inc end
         where player_id = l_badge_rec.player_id
           and badge_type_code = l_badge_rec.badge_type_code
           and tournament_session_id = l_badge_rec.tournament_session_id
           returning id into l_badge_rec.id;
      
          if SQL%ROWCOUNT = 0 then
            insert into wmg_player_badges(
                player_id
              , badge_type_code
              , tournament_session_id
              , badge_count
            )
            values (
                l_badge_rec.player_id
              , l_badge_rec.badge_type_code
              , l_badge_rec.tournament_session_id
              , l_badge_rec.badge_count
            )
            returning id into l_badge_rec.id;
      
          end if;
      
          apex_json.open_object; -- {
            apex_json.write('status', l_return);
            if l_return = 'ADDED' then
              apex_json.write('id', l_badge_rec.id);
              apex_json.write('badge', apex_application.g_x03);
            end if;
          apex_json.close_object; -- }
      
      end;
      
      

  execution: 
    sequence: 10
    point: Ajax Callback
    run-process: Once Per Page Visit (default)

  security: 
    authorization-scheme: Contribution Rights # 46986682878463702496

